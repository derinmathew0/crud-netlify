(this.webpackJsonpcrud=this.webpackJsonpcrud||[]).push([[0],{34:function(e,t,r){e.exports=r(46)},44:function(e,t,r){},45:function(e,t,r){},46:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),c=r(18),o=r.n(c),i=r(6),u=r(7),s=r(10),l=r(9),d=r(11),p=r(12),m=r(15),h=r(33);function v(e){var t=e.product,r=e.deleteProduct;return n.a.createElement("div",{className:"ui card"},n.a.createElement("div",{className:"image"},n.a.createElement("img",{src:t.cover,alt:t.title})),n.a.createElement("div",{className:"content"},n.a.createElement("div",{className:"header"},t.title)),n.a.createElement("div",{className:"extra content"},n.a.createElement("div",{className:"ui two buttons"},n.a.createElement(p.b,{to:"/product/".concat(t._id),className:"ui basic button green"},"Edit"),n.a.createElement("div",{className:"ui basic button red",onClick:function(){return r(t._id)}},"Delete"))))}function f(e){var t=e.products,r=e.deleteProduct,c=Object(a.useState)([]),o=Object(h.a)(c,2),i=o[0],u=o[1];Object(a.useEffect)((function(){s()}),[t]);var s=function(){u(Object(m.a)(t))},l=n.a.createElement("p",null,"There are no products yet in your collection."),d=n.a.createElement("div",{className:"ui four cards"},i.map((function(e){return n.a.createElement(v,{product:e,key:e._id,deleteProduct:r})}))),p=0;return n.a.createElement("div",null,n.a.createElement("input",{type:"test",onChange:function(e){return function(e){var r=e.target.value.toLowerCase();p&&clearTimeout(p),p=setTimeout((function(){var e=Object(m.a)(t).filter((function(e,t){return e.title.toLowerCase().indexOf(r)>=0}));u(e)}),300)}(e)},placeholder:"Search product",className:"product-search"}),0===t.length?l:d)}var E=r(14);function b(e){if(e.ok)return e.json();var t=new Error(e.statusText);throw t.response=e,t}var O=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"componentDidMount",value:function(){this.props.fetchProducts()}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("h1",null,"Products List"),n.a.createElement(f,{products:this.props.products,deleteProduct:this.props.deleteProduct}))}}]),r}(n.a.Component);var g=Object(E.b)((function(e){return{products:e.products}}),{fetchProducts:function(){return function(e){fetch("/api/products").then((function(e){return e.json()})).then((function(t){return e({type:"SET_PRODUCTS",products:t.products})}))}},deleteProduct:function(e){return function(t){return fetch("/api/products/".concat(e),{method:"delete",headers:{"Content-Type":"application/json"}}).then(b).then((function(r){return t({type:"PRODUCT_DELETED",productId:e})}))}}})(O),j=r(21),_=r(22),y=r.n(_),P=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;Object(i.a)(this,r);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={_id:e.props.product?e.props.product._id:null,title:e.props.product?e.props.product.title:"",cover:e.props.product?e.props.product.cover:"",errors:{},loading:!1},e.componentWillReceiveProps=function(t){e.setState({_id:t.product._id,title:t.product.title,cover:t.product.cover})},e.handleChange=function(t){if(e.state.errors[t.target.name]){var r,a=Object.assign({},e.state.errors);delete a[t.target.name],e.setState((r={},Object(j.a)(r,t.target.name,t.target.value),Object(j.a)(r,"errors",a),r))}else e.setState(Object(j.a)({},t.target.name,t.target.value))},e.isValidImageURL=function(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)&&null!=e.match(/\.(jpeg|jpg|gif|png)$/)},e.handleSubmit=function(t){t.preventDefault();var r={},a=e.isValidImageURL(e.state.cover);if(""===e.state.title&&(r.title="This field is required"),a||(r.cover="Invalid Image Url"),e.setState({errors:r}),0===Object.keys(r).length){var n=e.state,c=n._id,o=n.title,i=n.cover;e.setState({loading:!0}),e.props.saveProduct({_id:c,title:o,cover:i}).catch((function(t){return t.response.json().then((function(t){var r=t.errors;return e.setState({errors:r,loading:!1})}))}))}},e}return Object(u.a)(r,[{key:"render",value:function(){var e=n.a.createElement("form",{className:y()("ui","form",{loading:this.state.loading}),onSubmit:this.handleSubmit},n.a.createElement("h1",null,"Add new product"),!!this.state.errors.global&&n.a.createElement("div",{className:"ui negative message"},n.a.createElement("p",null,this.state.errors.global)),n.a.createElement("div",{className:y()("field",{error:!!this.state.errors.title})},n.a.createElement("label",{htmlFor:"title"},"Title"),n.a.createElement("input",{name:"title",value:this.state.title,onChange:this.handleChange,id:"title"}),n.a.createElement("span",null,this.state.errors.title)),n.a.createElement("div",{className:y()("field",{error:!!this.state.errors.cover})},n.a.createElement("label",{htmlFor:"cover"},"Product Image URL"),n.a.createElement("input",{name:"cover",value:this.state.cover,onChange:this.handleChange,id:"cover"}),n.a.createElement("span",null,this.state.errors.cover)),n.a.createElement("div",{className:"field"},""!==this.state.cover&&n.a.createElement("img",{src:this.state.cover,alt:this.state.title,className:"ui small bordered image"})),n.a.createElement("div",{className:"field"},n.a.createElement("button",{className:"ui primary button"},"Save")));return n.a.createElement("div",null,e)}}]),r}(n.a.Component),D=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;Object(i.a)(this,r);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={redirect:!1},e.componentDidMount=function(){var t=e.props.match;t.params._id&&e.props.fetchProduct(t.params._id)},e.saveProduct=function(t){var r=t._id,a=t.title,n=t.cover;return r?e.props.updateProduct({_id:r,title:a,cover:n}).then((function(){e.setState({redirect:!0})})):e.props.saveProduct({title:a,cover:n}).then((function(){e.setState({redirect:!0})}))},e}return Object(u.a)(r,[{key:"render",value:function(){return n.a.createElement("div",null,this.state.redirect?n.a.createElement(d.a,{to:"/products"}):n.a.createElement(P,{product:this.props.product,saveProduct:this.saveProduct}))}}]),r}(n.a.Component);var C=Object(E.b)((function(e,t){var r=t.match;return r.params._id?{product:e.products.find((function(e){return e._id===r.params._id}))}:{product:null}}),{saveProduct:function(e){return function(t){return fetch("/api/products",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(b).then((function(e){return t({type:"ADD_PRODUCT",product:e.product})}))}},fetchProduct:function(e){return function(t){fetch("/api/products/".concat(e)).then((function(e){return e.json()})).then((function(e){return t({type:"PRODUCT_FETCHED",product:e.product})}))}},updateProduct:function(e){return function(t){return fetch("/api/products/".concat(e._id),{method:"put",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(b).then((function(e){return t({type:"PRODUCT_UPDATED",product:e.product})}))}}})(D),T=(r(44),function(e){var t=e.label,r=e.to,a=e.activeOnlyWhenExact;return n.a.createElement(d.b,{path:r,exact:a,children:function(e){var a=e.match;return n.a.createElement(p.b,{className:a?"active item":"item",to:r},t)}})}),N=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){return n.a.createElement("div",{className:"ui container"},n.a.createElement("div",{className:"ui three item menu"},n.a.createElement(T,{activeOnlyWhenExact:!0,to:"/",label:"Home"}),n.a.createElement(T,{activeOnlyWhenExact:!0,to:"/products",label:"Products"}),n.a.createElement(T,{activeOnlyWhenExact:!0,to:"/products/new",label:"Add New Product"})),n.a.createElement(d.b,{exact:!0,path:"/products",component:g}),n.a.createElement(d.b,{path:"/products/new",component:C}),n.a.createElement(d.b,{path:"/product/:_id",component:C}))}}]),r}(a.Component),S=r(8),w=r(31);var R=Object(S.combineReducers)({products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"ADD_PRODUCT":return[].concat(Object(m.a)(e),[t.product]);case"PRODUCT_DELETED":return e.filter((function(e){return e._id!==t.productId}));case"PRODUCT_UPDATED":return e.map((function(e){return e._id===t.product._id?t.product:e}));case"PRODUCT_FETCHED":var r=e.findIndex((function(e){return e._id===t.product._id}));return r>-1?e.map((function(e){return e._id===t.product._id?t.product:e})):[].concat(Object(m.a)(e),[t.product]);case"SET_PRODUCTS":return t.products;default:return e}}}),U=r(32),x=(r(45),Object(S.createStore)(R,Object(U.composeWithDevTools)(Object(S.applyMiddleware)(w.a))));o.a.render(n.a.createElement(p.a,null,n.a.createElement(E.a,{store:x},n.a.createElement(N,null))),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.7b2ba844.chunk.js.map